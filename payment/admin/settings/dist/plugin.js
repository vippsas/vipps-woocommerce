(function(_,J){"use strict";var T=document.createElement("style");T.textContent=`.vipps-mobilepay-react-admin-page{color:#161225;font-family:Vipps Text,Roboto,Helvetica,Arial,sans-serif}.vipps-mobilepay-react-loading{display:inline-block;position:relative;width:20px;height:20px}.vipps-mobilepay-react-loading div{box-sizing:border-box;display:block;position:absolute;width:16px;height:16px;margin:2px;border:2px solid #666;border-radius:50%;animation:vipps-mobilepay-react-loading 1.2s cubic-bezier(.5,0,.5,1) infinite;border-color:#666 transparent transparent transparent}.vipps-mobilepay-react-loading div:nth-child(1){animation-delay:-.45s}.vipps-mobilepay-react-loading div:nth-child(2){animation-delay:-.3s}.vipps-mobilepay-react-loading div:nth-child(3){animation-delay:-.15s}@keyframes vipps-mobilepay-react-loading{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.vipps-mobilepay-react-form-field{margin-bottom:2rem;display:flex;gap:2rem}.vipps-mobilepay-react-form-field>label{width:20%;overflow-wrap:break-word}@media (min-width: 860px){.vipps-mobilepay-react-form-field>label{overflow-wrap:normal}}.vipps-mobilepay-react-form-field>div{width:85%}.vipps-mobilepay-react-col{display:flex;flex-direction:column;gap:.5rem}.vipps-mobilepay-react-label{font-weight:600;color:#1d2327;font-size:14px}.vipps-mobilepay-react-tab-description{margin-bottom:1rem}.vipps-mobilepay-react-field-description{color:#666}.vipps-mobilepay-react-button-actions{display:flex;column-gap:1rem}.vipps-mobilepay-react-notification-banner{padding:1rem;min-height:40px;font-size:1rem;display:flex;align-items:center}.vipps-mobilepay-react-notification-banner-error{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.vipps-mobilepay-react-notification-banner-warning{background-color:#fff3cd;color:#856404;border:1px solid #ffeeba}.vipps-mobilepay-react-notification-banner-success{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}.vipps-mobilepay-react-save-section{display:flex;align-items:center;gap:1rem}.vipps-mobilepay-react-save-confirmation{display:flex;align-items:center;gap:.5rem;color:#2a8947;font-weight:500}.vipps-mobilepay-react-save-confirmation .dashicons{font-size:1.2rem;width:auto;height:auto}.vipps-mobilepay-form-container{display:flex;flex-direction:column;align-items:flex-start;gap:3rem}@media (min-width: 420px){.vipps-mobilepay-form-container{display:flex;flex-direction:column;align-items:center;gap:3rem}}@media (min-width: 700px){.vipps-mobilepay-form-container{align-items:flex-start;flex-direction:row;gap:1rem,}}@media (min-width: 1280px){.vipps-mobilepay-form-container{gap:3rem}}.vipps-mobilepay-react-form-field{display:flex;flex-direction:row;justify-content:flex-start}.vipps-mobilepay-form-help-box{background-color:#fff;border-color:#8c8f94;border-radius:4px;border:1px solid #8c8f94;padding:30px;width:13rem;margin-left:auto;margin-right:auto}@media (min-width: 420px){.vipps-mobilepay-form-help-box{margin-left:0;margin-right:0}}.vipps-mobilepay-form-help-box a{text-wrap:nowrap}.vipps-mobilepay-react-checkout-confirm .body{display:flex;flex-direction:column;gap:5rem;margin-bottom:2rem}@media (min-width: 870px){.vipps-mobilepay-react-checkout-confirm .body{display:flex;flex-direction:row;gap:5rem}}.vipps-mobilepay-react-checkout-confirm .title{margin-bottom:1em;font-weight:700}.vipps-mobilepay-react-checkout-confirm li{list-style:inside;margin-left:1em}.vipps-mobilepay-react-checkout-confirm img{margin-right:50px;width:20rem;display:flex;align-items:center;justify-content:center}@media (min-width: 1280px){.vipps-mobilepay-react-checkout-confirm img{width:30rem}}.vipps-mobilepay-react-checkout .title{margin-bottom:1em;font-weight:700}
`,document.head.appendChild(T);var P={},A=J;P.createRoot=A.createRoot,P.hydrateRoot=A.hydrateRoot;const w=window;if(!w.VippsMobilePayReactTranslations)throw new Error("VippsMobilePayReactTranslations not found, make sure to include this using wp_localize_script()");if(!w.VippsMobilePayReactOptions)throw new Error("VippsMobilePayReactOptions not found, make sure to include this using wp_localize_script()");if(!w.VippsMobilePayReactMetadata)throw new Error("VippsMobilePayReactMetadata not found, make sure to include this using wp_localize_script()");function t(e){let a=w.VippsMobilePayReactTranslations;const n=e.split(".");for(const i of n)if(typeof a=="object"&&a!==null)a=a[i];else break;return a!==void 0?a:e}function x(e){var a;return((a=w.VippsMobilePayReactMetadata)==null?void 0:a[e])??null}const{VippsMobilePayReactTranslations:ve,VippsMobilePayReactOptions:Z,VippsMobilePayReactMetadata:fe}=w;function G({tabs:e,onTabChange:a,activeTab:n}){return React.createElement("div",{className:"vippstabholder",id:"vippstabholder"},e.map((i,r)=>React.createElement("h3",{key:r,id:`woocommerce_vipps_${i}_options`,"aria-selected":i===n?"true":"false",className:`wc-settings-sub-title tab ${i===n?"active":""}`,title:i,onClick:()=>a(i),style:{cursor:"pointer"}},i)))}function V(e){switch(e){case"NO":return"Vipps";case"SE":return"Vipps";case"FI":return"MobilePay";case"DK":return"MobilePay"}return"MobilePay"}function z(e){switch(e){case"Vipps":return["NOK","SEK"];case"MobilePay":return["DKK","EUR"];default:return[]}}function U(e,a){return a?z(e).includes(a):!1}const W=_.createContext(null);function Q({children:e}){const[a,n]=_.useState(Z);function i(o){const u=a[o],h=o+".default",b=t(h),c=b!=h?b:null;return u??c??""}function r(o){const u=o+".default";return t(u)!=u}async function s(o,u){console.log("setOption called:",{key:o,value:u}),n(h=>({...h,[o]:u??null}))}async function d(o){n(o)}async function m(o){console.log("submitChanges - Current values:",a),o!=null&&o.forceEnable&&(s("enabled","yes"),a.enabled="yes");const u=document.getElementById("vippsadmin_nonce").value,h=new URLSearchParams({action:"vipps_update_admin_settings",vippsadmin_nonce:u});for(const[v,g]of Object.entries(a)){const I="values["+v+"]";g?h.append(I,g):h.append(I,"")}const c=await(await fetch(x("admin_url"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},credentials:"include",body:h.toString()})).json();return console.log("submitChanges - Server response:",c),c}return React.createElement(W.Provider,{value:{setOption:s,getOption:i,hasOption:r,setOptions:d,submitChanges:m}},e)}function R(){const e=_.useContext(W);if(!e)throw new Error("useWP must be used within a WPOptionsProvider");return e}const l=(e,a)=>e.replace(/Vipps MobilePay Checkout/g,a==="Vipps"?"Vipps Checkout":"MobilePay Checkout");function X(){return React.createElement("div",{className:"vipps-mobilepay-react-loading"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null))}function Y(e){return React.createElement("input",{...e,className:["input-text regular-input",e.className??""].join(" "),style:{height:30}},e.children)}function $(e){return React.createElement("form",{...e,className:["",e.className??""].join(" ")},e.children)}function N(e){return React.createElement("label",{...e,className:["vipps-mobilepay-react-label",e.className??""].join(" ")},e.children)}function K({variant:e,isLoading:a,disabled:n,...i}){return React.createElement("button",{...i,disabled:a||n,className:[`button-${e}`,i.className??""].join(" ")},React.createElement("div",{style:{display:"flex",alignItems:"center"}},a&&React.createElement(X,null),React.createElement("span",null,i.children)))}function ee({id:e,name:a,onChange:n,checked:i,children:r,className:s}){return React.createElement("input",{id:e,name:a,checked:i?F(i):void 0,onChange:d=>n(j(d.target.checked)),type:"checkbox",className:[s??""].join(" ")},r)}function te({error:e,...a}){return React.createElement("div",null,React.createElement("select",{...a,className:["",a.className??"",e?"has-error":""].join(" ")},a.children),e&&React.createElement("div",{className:"vipps-mobilepay-react-field-error"},e.split(`
`).map((n,i)=>React.createElement("div",{key:i},n))))}function L(e){return React.createElement("option",{...e,className:[e.className??""].join(" ")},e.children)}function ae(e){return React.createElement("textarea",{...e,className:[e.className??""].join(" ")},e.children)}function S(e){return React.createElement("div",{...e,className:["vipps-mobilepay-react-form-field",e.className??""].join(" ")},e.children)}function F(e){return e==="yes"}function j(e){return e?"yes":"no"}function H(e){return F(e)?"no":"yes"}function E({htmlString:e,className:a=""}){return React.createElement("span",{className:[a].join(" "),dangerouslySetInnerHTML:{__html:e}})}function p({name:e,titleKey:a,labelKey:n,descriptionKey:i,inverted:r=!1}){const{getOption:s,setOption:d}=R(),m=s("payment_method_name");return React.createElement(S,null,React.createElement(N,{htmlFor:e},l(t(a),m)),React.createElement("div",{className:"vipps-mobilepay-react-col"},React.createElement("div",{className:"vipps-mobilepay-react-row-center"},React.createElement(ee,{id:e,name:e,checked:r?H(s(e)):s(e),onChange:o=>r?d(e,H(o)):d(e,o)}),n&&React.createElement("label",{htmlFor:e},React.createElement(E,{htmlString:l(t(n),m)}))),i&&React.createElement(E,{className:"vipps-mobilepay-react-field-description",htmlString:l(t(i),m)})))}function k({name:e,titleKey:a,labelKey:n,descriptionKey:i,options:r,onChange:s,required:d=!1,includeEmptyOption:m=!1,error:o}){const{getOption:u,setOption:h}=R(),b=u("payment_method_name");return React.createElement(S,null,React.createElement(N,{htmlFor:e},l(t(a),b)),React.createElement("div",{className:"vipps-mobilepay-react-col"},React.createElement(te,{id:e,name:e,onChange:c=>{h(e,c.target.value),s&&s(c)},required:d,value:u(e),error:o},m&&React.createElement(L,{value:""}),r.map(c=>React.createElement(L,{key:c.value,value:c.value},c.label))),React.createElement("div",null,n&&React.createElement(E,{htmlString:l(t(n),b)})),i&&React.createElement(E,{className:"vipps-mobilepay-react-field-description",htmlString:l(t(i),b)})))}function y({name:e,titleKey:a,labelKey:n,descriptionKey:i,pattern:r,required:s,asterisk:d,type:m="text"}){const{getOption:o,setOption:u}=R(),[h,b]=_.useState(!1),c=!h&&d,v=o("payment_method_name");return React.createElement(S,null,React.createElement(N,{htmlFor:e},l(t(a),v)),React.createElement("div",{className:"vipps-mobilepay-react-col"},React.createElement(Y,{id:e,name:e,onChange:g=>u(e,g.target.value),value:o(e),pattern:r,required:s,onFocus:()=>b(!0),onBlur:()=>b(!1),type:c?"password":m}),React.createElement("div",null,n&&React.createElement(E,{htmlString:l(t(n),v)})),i&&React.createElement(E,{className:"vipps-mobilepay-react-field-description",htmlString:l(t(i),v)})))}function ie({name:e,titleKey:a,labelKey:n,descriptionKey:i,rows:r=5}){const{getOption:s,setOption:d}=R(),m=s("payment_method_name");return React.createElement(S,null,React.createElement(N,{htmlFor:e},l(t(a),m)),React.createElement("div",{className:"vipps-mobilepay-react-col"},React.createElement(ae,{id:e,name:e,onChange:o=>d(e,o.target.value),value:s(e),rows:r}),React.createElement("div",null,n&&React.createElement(E,{htmlString:l(t(n),m)})),i&&React.createElement(E,{className:"vipps-mobilepay-react-field-description",htmlString:l(t(i),m)})))}function ne(){const{setOption:e,getOption:a}=R();return React.createElement("div",null,React.createElement("p",{className:"vipps-mobilepay-react-tab-description"}),React.createElement(p,{name:"enabled",titleKey:"enabled.title",labelKey:"enabled.label"}),React.createElement(k,{name:"country",titleKey:"country.title",descriptionKey:"country.description",includeEmptyOption:!1,required:!0,onChange:n=>{const i=V(n.target.value);a("payment_method_name")||e("payment_method_name",i)},options:[{label:t("country.options.NO"),value:"NO"},{label:t("country.options.SE"),value:"SE"},{label:t("country.options.FI"),value:"FI"},{label:t("country.options.DK"),value:"DK"}]}),React.createElement(k,{name:"payment_method_name",titleKey:"payment_method_name.title",descriptionKey:"payment_method_name.description",includeEmptyOption:!1,required:!0,error:U(a("payment_method_name"),x("currency"))?void 0:`${a("payment_method_name")} does not support your store currency (${x("currency")}). Supported currencies: ${z(a("payment_method_name")).join(", ")}`,options:[{label:t("payment_method_name.options.Vipps"),value:"Vipps"},{label:t("payment_method_name.options.MobilePay"),value:"MobilePay"}]}),React.createElement(y,{name:"orderprefix",titleKey:"orderprefix.title",descriptionKey:"orderprefix.description",pattern:"[a-zA-Z0-9-]+",required:!0}),React.createElement(y,{asterisk:!0,name:"merchantSerialNumber",titleKey:"merchantSerialNumber.title",descriptionKey:"merchantSerialNumber.description"}),React.createElement(y,{asterisk:!0,name:"clientId",titleKey:"clientId.title",descriptionKey:"clientId.description"}),React.createElement(y,{asterisk:!0,name:"secret",titleKey:"secret.title",descriptionKey:"secret.description"}),React.createElement(y,{asterisk:!0,name:"Ocp_Apim_Key_eCommerce",titleKey:"Ocp_Apim_Key_eCommerce.title",descriptionKey:"Ocp_Apim_Key_eCommerce.description"}),React.createElement(k,{name:"result_status",titleKey:"result_status.title",descriptionKey:"result_status.description",options:[{label:t("result_status.options.on-hold"),value:"on-hold"},{label:t("result_status.options.processing"),value:"processing"}]}),React.createElement(ie,{name:"description",titleKey:"description.title",descriptionKey:"description.description",rows:5}),React.createElement(p,{name:"vippsdefault",titleKey:"vippsdefault.title",labelKey:"vippsdefault.label"}))}function ce(){return React.createElement("div",null,React.createElement("p",{className:"vipps-mobilepay-react-tab-description"},t("express_options.description")),React.createElement(p,{name:"cartexpress",titleKey:"cartexpress.title",labelKey:"cartexpress.title",descriptionKey:"cartexpress.description"}),React.createElement(k,{name:"singleproductexpress",titleKey:"singleproductexpress.title",descriptionKey:"singleproductexpress.description",options:[{value:"none",label:t("singleproductexpress.options.none")},{value:"some",label:t("singleproductexpress.options.some")},{value:"all",label:t("singleproductexpress.options.all")}]}),React.createElement(p,{name:"singleproductexpressarchives",titleKey:"singleproductexpressarchives.title",labelKey:"singleproductexpressarchives.label",descriptionKey:"singleproductexpressarchives.description"}),React.createElement(p,{name:"expresscheckout_termscheckbox",titleKey:"expresscheckout_termscheckbox.title",labelKey:"expresscheckout_termscheckbox.label",descriptionKey:"expresscheckout_termscheckbox.description"}),React.createElement(p,{name:"expresscheckout_always_address",titleKey:"expresscheckout_always_address.title",labelKey:"expresscheckout_always_address.label",descriptionKey:"expresscheckout_always_address.description"}),React.createElement(p,{name:"enablestaticshipping",titleKey:"enablestaticshipping.title",labelKey:"enablestaticshipping.label",descriptionKey:"enablestaticshipping.description"}),React.createElement(p,{name:"expresscreateuser",titleKey:"expresscreateuser.title",labelKey:"expresscreateuser.label",descriptionKey:"expresscreateuser.description"}),React.createElement(p,{name:"singleproductbuynowcompatmode",titleKey:"singleproductbuynowcompatmode.title",labelKey:"singleproductbuynowcompatmode.label",descriptionKey:"singleproductbuynowcompatmode.description"}),React.createElement(p,{name:"deletefailedexpressorders",titleKey:"deletefailedexpressorders.title",labelKey:"deletefailedexpressorders.label",descriptionKey:"deletefailedexpressorders.description"}))}function re(){const{getOption:e,hasOption:a}=R(),n=e("vcs_porterbuddy")==="yes",i=e("vcs_helthjem")==="yes",r=a("checkout_external_payments_klarna"),s=r,d=e("payment_method_name");return React.createElement("div",null,React.createElement("p",{className:"vipps-mobilepay-react-tab-description"},React.createElement(E,{htmlString:l(t("checkout_options.description"),d)})),React.createElement(p,{name:"vipps_checkout_enabled",titleKey:"vipps_checkout_enabled.title",labelKey:"vipps_checkout_enabled.label",descriptionKey:"vipps_checkout_enabled.description"}),React.createElement(p,{name:"checkoutcreateuser",titleKey:"checkoutcreateuser.title",labelKey:"checkoutcreateuser.label",descriptionKey:"checkoutcreateuser.description"}),React.createElement(p,{name:"enablestaticshipping_checkout",titleKey:"enablestaticshipping_checkout.title",labelKey:"enablestaticshipping_checkout.label",descriptionKey:"enablestaticshipping_checkout.description"}),React.createElement(p,{name:"requireUserInfo_checkout",titleKey:"requireUserInfo_checkout.title",labelKey:"requireUserInfo_checkout.label",descriptionKey:"requireUserInfo_checkout.description"}),React.createElement(p,{name:"noAddressFields",titleKey:"noAddressFields.title",labelKey:"noAddressFields.label",descriptionKey:"noAddressFields.description"}),React.createElement(p,{name:"noContactFields",titleKey:"noContactFields.title",labelKey:"noContactFields.label",descriptionKey:"noContactFields.description"}),s&&React.createElement(React.Fragment,null,React.createElement("h3",{className:"vipps-mobilepay-react-trab-description"},l(t("checkout_external_payment_title.title"),d)),React.createElement("p",null,l(t("checkout_external_payment_title.description"),d)),r&&React.createElement(p,{name:"checkout_external_payments_klarna",titleKey:"checkout_external_payments_klarna.title",labelKey:"checkout_external_payments_klarna.label",descriptionKey:"checkout_external_payments_klarna.description"})),React.createElement("h3",{className:"vipps-mobilepay-react-tab-description"},l(t("checkout_shipping.title"),d)),React.createElement("p",null,l(t("checkout_shipping.description"),d)),React.createElement(p,{name:"vcs_posten",titleKey:"vcs_posten.title",descriptionKey:"vcs_posten.description",labelKey:"vcs_posten.label"}),React.createElement(p,{name:"vcs_postnord",titleKey:"vcs_postnord.title",descriptionKey:"vcs_postnord.description",labelKey:"vcs_postnord.label"}),React.createElement(p,{name:"vcs_porterbuddy",titleKey:"vcs_porterbuddy.title",descriptionKey:"vcs_porterbuddy.description",labelKey:"vcs_porterbuddy.label"}),n&&React.createElement(React.Fragment,null,React.createElement(y,{asterisk:!0,name:"vcs_porterbuddy_publicToken",titleKey:"vcs_porterbuddy_publicToken.title",descriptionKey:"vcs_porterbuddy_publicToken.description"}),React.createElement(y,{asterisk:!0,name:"vcs_porterbuddy_apiKey",titleKey:"vcs_porterbuddy_apiKey.title",descriptionKey:"vcs_porterbuddy_apiKey.description"}),React.createElement(y,{name:"vcs_porterbuddy_phoneNumber",titleKey:"vcs_porterbuddy_phoneNumber.title",descriptionKey:"vcs_porterbuddy_phoneNumber.description"})),React.createElement(p,{name:"vcs_helthjem",titleKey:"vcs_helthjem.title",descriptionKey:"vcs_helthjem.description",labelKey:"vcs_helthjem.label"}),i&&React.createElement(React.Fragment,null,React.createElement(y,{type:"number",name:"vcs_helthjem_shopId",titleKey:"vcs_helthjem_shopId.title",descriptionKey:"vcs_helthjem_shopId.description"}),React.createElement(y,{name:"vcs_helthjem_username",titleKey:"vcs_helthjem_username.title",descriptionKey:"vcs_helthjem_username.description"}),React.createElement(y,{asterisk:!0,name:"vcs_helthjem_password",titleKey:"vcs_helthjem_password.title",descriptionKey:"vcs_helthjem_password.description"})))}function le({onUpload:e}){return{handleImageUpload:()=>{const n=wp.media({library:{type:"image"},button:{},multiple:!1});n.on("select",()=>{const i=n.state().get("selection").first().toJSON();let r="";i.url?r=i.url:i.sizes&&i.sizes.thumbnail&&(r=i.sizes.thumbnail.url),r&&e(i.id,r)}),n.open()}}}function M({variant:e,text:a}){return React.createElement("div",{className:`vipps-mobilepay-react-notification-banner vipps-mobilepay-react-notification-banner-${e}`},Array.isArray(a)?a.map((n,i)=>React.createElement("p",{key:i},n)):React.createElement("p",null,a))}function se(){const{getOption:e,setOption:a}=R(),[n,i]=_.useState(null);function r(){a("receiptimage",""),a("receiptimage_url",""),i(null)}const{handleImageUpload:s}=le({onUpload(o,u){const h=new Image;h.src=u,h.onload=()=>{if(h.height<167){i(t("receipt_image_error"));return}i(null),console.log("Image Upload - Setting values:",{id:o,url:u}),a("receiptimage",o),a("receiptimage_url",u)}}}),d=e("receiptimage"),m=e("receiptimage_url");return React.createElement("div",null,React.createElement("p",{className:"vipps-mobilepay-react-tab-description"},t("advanced_options.description")),React.createElement(p,{labelKey:"vippsorderattribution.label",name:"vippsorderattribution",titleKey:"vippsorderattribution.title",descriptionKey:"vippsorderattribution.description"}),React.createElement(k,{name:"vippsspecialpagetemplate",titleKey:"vippsspecialpagetemplate.title",descriptionKey:"vippsspecialpagetemplate.description",options:Object.entries(t("vippsspecialpagetemplate.options")).map(([o,u])=>({label:u,value:o||""}))}),React.createElement(k,{name:"vippsspecialpageid",titleKey:"vippsspecialpageid.title",descriptionKey:"vippsspecialpageid.description",options:Object.entries(t("vippsspecialpageid.options")).map(([o,u])=>({label:u,value:o||""}))}),React.createElement(p,{name:"sendreceipts",titleKey:"sendreceipts.title",labelKey:"sendreceipts.label",descriptionKey:"sendreceipts.description"}),n&&React.createElement(M,{variant:"error",text:n}),React.createElement(S,null,React.createElement(N,{htmlFor:"woocommerce_vipps_receiptimage"},t("receiptimage.title")),React.createElement("div",{className:"vipps-mobilepay-react-col"},React.createElement("div",null,d?React.createElement(React.Fragment,null,React.createElement("img",{src:m,id:d,style:{width:200}}),React.createElement(K,{type:"button",onClick:r,variant:"link"},t("remove_image"))):React.createElement(K,{type:"button",onClick:s,variant:"link"},t("upload_image")),React.createElement("input",{type:"hidden",name:"woocommerce_vipps_receiptimage",id:"woocommerce_vipps_receiptimage",value:d})),React.createElement("span",{className:"vipps-mobilepay-react-field-description"},t("receiptimage.description"),React.createElement("br",null),React.createElement("small",null,t("receipt_image_size_requirement"))))),React.createElement(p,{name:"use_flock",titleKey:"use_flock.title",descriptionKey:"use_flock.description",labelKey:"use_flock.label"}),React.createElement(p,{name:"developermode",titleKey:"developermode.title",descriptionKey:"developermode.description",labelKey:"developermode.label"}))}function oe(e){const[a,n]=_.useState(()=>window.location.hash),i=_.useCallback(()=>{n(window.location.hash)},[]);_.useEffect(()=>(window.addEventListener("hashchange",i),()=>{window.removeEventListener("hashchange",i)}),[i]);const r=_.useCallback(d=>{d!==a&&(window.location.hash="#"+d)},[a]);return _.useEffect(()=>{!a&&e&&r(e)},[a,e,r]),[decodeURIComponent(a.replace("#","")),r]}function pe(){return React.createElement("div",null,React.createElement("p",{className:"vipps-mobilepay-react-tab-description"},t("developertitle.description")),React.createElement(p,{name:"testmode",titleKey:"testmode.title",descriptionKey:"testmode.description",labelKey:"testmode.label"}),React.createElement(y,{name:"merchantSerialNumber_test",titleKey:"merchantSerialNumber_test.title",labelKey:"merchantSerialNumber_test.description"}),React.createElement(y,{asterisk:!0,name:"clientId_test",titleKey:"clientId_test.title",labelKey:"clientId_test.description"}),React.createElement(y,{asterisk:!0,name:"secret_test",titleKey:"secret_test.title",labelKey:"secret_test.description"}),React.createElement(y,{asterisk:!0,name:"Ocp_Apim_Key_eCommerce_test",titleKey:"Ocp_Apim_Key_eCommerce_test.title",labelKey:"Ocp_Apim_Key_eCommerce_test.description"}))}function me({isLoading:e}){const{getOption:a,setOption:n,hasOption:i}=R(),[r,s]=_.useState("ESSENTIAL"),[d,m]=_.useState("ESSENTIAL"),o=a("vcs_porterbuddy")==="yes",u=a("vcs_helthjem")==="yes",h=i("checkout_external_payments_klarna"),b=h,c=a("payment_method_name");return React.createElement(React.Fragment,null,r==="ESSENTIAL"&&React.createElement(React.Fragment,null,React.createElement("h3",{className:"vipps-mobilepay-react-tab-description"},t("wizard_header.title")),React.createElement("p",null,t("wizard_header.description")),React.createElement("div",{className:"vipps-mobilepay-form-container"},React.createElement("div",{className:"vipps-mobilepay-form-col"},React.createElement(k,{name:"country",titleKey:"country.title",descriptionKey:"country.description",onChange:v=>{const g=V(v.target.value);n("payment_method_name",g)},required:!0,includeEmptyOption:!1,options:[{label:t("country.options.NO"),value:"NO"},{label:t("country.options.SE"),value:"SE"},{label:t("country.options.FI"),value:"FI"},{label:t("country.options.DK"),value:"DK"}]}),React.createElement(k,{name:"payment_method_name",titleKey:"payment_method_name.title",descriptionKey:"payment_method_name.description",required:!0,includeEmptyOption:!1,options:[{label:t("payment_method_name.options.Vipps"),value:"Vipps"},{label:t("payment_method_name.options.MobilePay"),value:"MobilePay"}]}),React.createElement(y,{asterisk:!0,name:"merchantSerialNumber",titleKey:"merchantSerialNumber.title",descriptionKey:"merchantSerialNumber.description",required:!0}),React.createElement(y,{asterisk:!0,name:"clientId",titleKey:"clientId.title",descriptionKey:"clientId.description",required:!0}),React.createElement(y,{asterisk:!0,name:"secret",titleKey:"secret.title",descriptionKey:"secret.description",required:!0}),React.createElement(y,{asterisk:!0,name:"Ocp_Apim_Key_eCommerce",titleKey:"Ocp_Apim_Key_eCommerce.title",descriptionKey:"Ocp_Apim_Key_eCommerce.description",required:!0}),React.createElement("h3",{className:"vipps-mobilepay-react-tab-description"},l(t("vipps_checkout_enabled_wizard.title"),c)),React.createElement("p",null,React.createElement(E,{htmlString:l(t("vipps_checkout_enabled_wizard.description"),c)})),React.createElement(p,{name:"vipps_checkout_enabled",titleKey:"",labelKey:"vipps_checkout_enabled_wizard.label",descriptionKey:""}),React.createElement(S,null,React.createElement(N,null),React.createElement("div",{className:"vipps-mobilepay-react-col"},React.createElement(K,{style:{alignSelf:"flex-start"},variant:"primary",type:"button",onClick:v=>{v.preventDefault();const g=v.currentTarget.closest("form");if(!g)throw new Error("Form not found");g.reportValidity()&&(m(r),F(a("vipps_checkout_enabled"))?s("CHECKOUT"):s("CHECKOUT_CONFIRM"))}},t("next_step"))))),React.createElement("div",{className:"vipps-mobilepay-form-col vipps-mobilepay-form-help-box"},React.createElement("div",null,React.createElement("strong",{className:"title"},t("help_box.get_started")),React.createElement("br",null),React.createElement("a",{href:"https://wordpress.org/plugins/woo-vipps/",target:"_blank"},t("help_box.documentation")),React.createElement("br",null),React.createElement("a",{href:"https://portal.vippsmobilepay.com",target:"_blank"},t("help_box.portal"))),React.createElement("br",null),React.createElement("div",null,React.createElement("strong",{className:"title"},t("help_box.support.title")),React.createElement("br",null),React.createElement(E,{htmlString:t("help_box.support.description")}))))),r==="CHECKOUT_CONFIRM"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"vipps-mobilepay-react-checkout-confirm"},React.createElement("h1",{className:"title"},l(t("checkout_confirm.title"),a("payment_method_name"))),React.createElement("p",null,l(t("checkout_options_wizard.description"),c)),React.createElement("div",{className:"body"},React.createElement("div",{className:"list"},React.createElement("strong",null,l(t("checkout_confirm.paragraph1.header"),c)),React.createElement("ul",null,React.createElement("li",null,l(t("checkout_confirm.paragraph1.first"),c)),React.createElement("li",null,l(t("checkout_confirm.paragraph1.second"),c)),React.createElement("li",null,l(t("checkout_confirm.paragraph1.third"),c))),React.createElement("strong",null,l(t("checkout_confirm.paragraph2.header"),c)),React.createElement("ul",null,React.createElement("li",null,l(t("checkout_confirm.paragraph2.first"),c)),React.createElement("li",null,l(t("checkout_confirm.paragraph2.second"),c)))),React.createElement("img",{src:t(c==="Vipps"?"checkout_confirm.img.vipps.src":"checkout_confirm.img.mobilepay.src"),alt:t("checkout_confirm.img.vipps.alt")})),React.createElement("div",{className:"vipps-mobilepay-react-button-actions"},React.createElement(K,{variant:"secondary",type:"button",onClick:()=>s(d)},l(t("previous_step"),c)),React.createElement(K,{variant:"primary",isLoading:e,onClick:()=>{n("vipps_checkout_enabled",j(!0)),m(r),s("CHECKOUT")}},l(t("checkout_confirm.accept"),c)),React.createElement(K,{variant:"secondary",onClick:()=>n("vipps_checkout_enabled",j(!1))},l(t("checkout_confirm.skip"),c))))),r==="CHECKOUT"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"vipps-mobilepay-react-checkout-confirm"},React.createElement("h1",{className:"vipps-mobilepay-react-tab-description title"},l(t("checkout_options_wizard.title"),c)),React.createElement("p",null,l(t("checkout_options_wizard.description"),c)),React.createElement(p,{name:"checkoutcreateuser",titleKey:"checkoutcreateuser_wizard.title",labelKey:"checkoutcreateuser_wizard.label",descriptionKey:"checkoutcreateuser_wizard.description"}),React.createElement(p,{name:"enablestaticshipping_checkout",titleKey:"enablestaticshipping_checkout_wizard.title",labelKey:"enablestaticshipping_checkout_wizard.label",descriptionKey:"enablestaticshipping_checkout_wizard.description",inverted:!0}),React.createElement(p,{name:"noAddressFields",titleKey:"noAddressFields_wizard.title",labelKey:"noAddressFields_wizard.label",descriptionKey:"noAddressFields_wizard.description",inverted:!0}),React.createElement("h3",{className:"vipps-mobilepay-react-tab-description"},l(t("checkout_shipping_wizard.title"),c)),React.createElement("p",null,l(t("checkout_shipping_wizard.description"),c)),React.createElement(p,{name:"vcs_posten",titleKey:"vcs_posten_wizard.title",labelKey:"vcs_posten_wizard.label",descriptionKey:"vcs_posten_wizard.description"}),React.createElement(p,{name:"vcs_postnord",titleKey:"vcs_postnord_wizard.title",labelKey:"vcs_postnord_wizard.label",descriptionKey:"vcs_postnord_wizard.description"}),React.createElement(p,{name:"vcs_porterbuddy",titleKey:"vcs_porterbuddy_wizard.title",labelKey:"vcs_porterbuddy_wizard.label",descriptionKey:"vcs_porterbuddy_wizard.description"}),o&&React.createElement(React.Fragment,null,React.createElement(y,{asterisk:!0,name:"vcs_porterbuddy_publicToken",titleKey:"vcs_porterbuddy_publicToken.title",descriptionKey:"vcs_porterbuddy_publicToken.description"}),React.createElement(y,{asterisk:!0,name:"vcs_porterbuddy_apiKey",titleKey:"vcs_porterbuddy_apiKey.title",descriptionKey:"vcs_porterbuddy_apiKey.description"}),React.createElement(y,{name:"vcs_porterbuddy_phoneNumber",titleKey:"vcs_porterbuddy_phoneNumber.title",descriptionKey:"vcs_porterbuddy_phoneNumber.description"})),React.createElement(p,{name:"vcs_helthjem",titleKey:"vcs_helthjem_wizard.title",labelKey:"vcs_helthjem_wizard.label",descriptionKey:"vcs_helthjem_wizard.description"}),u&&React.createElement(React.Fragment,null,React.createElement(y,{type:"number",name:"vcs_helthjem_shopId",titleKey:"vcs_helthjem_shopId.title",descriptionKey:"vcs_helthjem_shopId.description"}),React.createElement(y,{name:"vcs_helthjem_username",titleKey:"vcs_helthjem_username.title",descriptionKey:"vcs_helthjem_username.description"}),React.createElement(y,{asterisk:!0,name:"vcs_helthjem_password",titleKey:"vcs_helthjem_password.title",descriptionKey:"vcs_helthjem_password.description"})),b&&React.createElement(React.Fragment,null,React.createElement("h3",{className:"vipps-mobilepay-react-trab-description"},l(t("checkout_external_payment_title.title"),c)),React.createElement("p",null,l(t("checkout_external_payment_title.description"),c)),h&&React.createElement(p,{name:"checkout_external_payments_klarna",titleKey:"checkout_external_payments_klarna.title",labelKey:"checkout_external_payments_klarna.label",descriptionKey:"checkout_external_payments_klarna.description"})),React.createElement("div",{className:"vipps-mobilepay-react-button-actions"},React.createElement(K,{variant:"secondary",type:"button",onClick:()=>{s(d),m("ESSENTIAL")}},l(t("previous_step"),c)),React.createElement(K,{variant:"primary",isLoading:e},l(t("save_changes"),c))))))}function de(){const[e,a]=_.useState(!1),[n,i]=_.useState(),[r,s]=_.useState(!1),{submitChanges:d,getOption:m,setOptions:o}=R(),u=x("currency"),h=m("payment_method_name"),b=!U(h,u),c=[t("main_options.title"),t("express_options.title"),t("checkout_options.title"),t("advanced_options.title")],v=m("developermode")==="yes";v&&c.push(t("developertitle.title"));const g=x("__dev_force_wizard_screen")||"",I=["1","yes","true","TRUE"].includes(g),[q,ye]=oe(c[0]);function O(C){return C===q}async function he(C){C.preventDefault(),a(!0),s(!1);try{const f=await d({forceEnable:B});console.log("handleSaveSettings - Response data:",f),!f.connection_ok||!f.form_ok?(i({text:f.connection_msg||f.form_errors,variant:"error"}),s(!1)):(i({text:f.connection_msg,variant:"success"}),s(!0),console.log("handleSaveSettings - Setting new options:",f.options),await o(f.options),_e(D()),setTimeout(()=>{s(!1)},2e3))}catch(f){console.error("handleSaveSettings - Error:",f),i({text:f.message,variant:"error"}),s(!1)}finally{a(!1)}}function D(){const C=m("merchantSerialNumber")&&m("clientId")&&m("secret")&&m("Ocp_Apim_Key_eCommerce")&&m("country")&&m("payment_method_name"),f=F(m("testmode")),be=m("merchantSerialNumber_test")&&m("clientId_test")&&m("secret_test")&&m("Ocp_Apim_Key_eCommerce_test")&&m("payment_method_name")&&m("country");return!C&&!be&&!f}const[B,_e]=_.useState(()=>I||D());return React.createElement(React.Fragment,null,n&&React.createElement(M,{variant:n.variant,text:n.text}),b&&React.createElement(M,{variant:"error",text:`${h} does not support your store currency (${u}). Supported currencies: ${z(h).join(", ")}`}),React.createElement($,{onSubmit:he,className:"vippsAdminSettings"},B?React.createElement(me,{isLoading:e}):React.createElement(React.Fragment,null,React.createElement(G,{tabs:c,onTabChange:ye,activeTab:q}),O(c[0])&&React.createElement(ne,null),O(c[1])&&React.createElement(ce,null),O(c[2])&&React.createElement(re,null),O(c[3])&&React.createElement(se,null),v&&O(c[4])&&React.createElement(pe,null),React.createElement("div",{className:"vipps-mobilepay-react-save-section"},React.createElement(K,{variant:"primary",isLoading:e},t("save_changes")),r&&React.createElement("span",{className:"vipps-mobilepay-react-save-confirmation"},React.createElement("span",{className:"dashicons dashicons-yes"}),t("settings_saved"))))))}function ue(){const e=x("page")==="admin_settings_page";return React.createElement("div",{className:"vipps-mobilepay-react-admin-page"},e&&React.createElement(Q,null,React.createElement(de,null)))}P.createRoot(document.getElementById("vipps-mobilepay-react-ui")).render(_.createElement(_.StrictMode,null,_.createElement(ue,null)))})(wp.element,wp.element);
