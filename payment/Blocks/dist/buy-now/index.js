(()=>{"use strict";var t={n:o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return t.d(e,{a:e}),e},d:(o,e)=>{for(var n in e)t.o(e,n)&&!t.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:e[n]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o)};const o=window.wp.blocks,e=window.React,n=window.wp.i18n,s=window.wp.blockEditor,i=window.wp.components,r=window.wp.primitives,a=(0,e.createElement)(r.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(r.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})),c=window.wp.apiFetch;var l=t.n(c);const p=window.ReactJSXRuntime;function u({attributes:t,setAttributes:o,hideCallback:s}){const[r,a]=(0,e.useState)(t.productName),[c,u]=(0,e.useState)([]),[d,w]=(0,e.useState)(!1);(0,e.useEffect)((()=>{if(r.length<3)return void u([]);const t=setTimeout((async()=>{w(!0);try{const t=(await l()({path:`/wc/store/products?search=${encodeURIComponent(r)}&per_page=10`})).map((t=>({label:t.name,value:t.id.toString()})));u(t)}catch(t){console.error("Error fetching products:",t),u([])}finally{w(!1)}}),300);return()=>clearTimeout(t)}),[r]);const v=()=>{o({productId:void 0,productName:void 0})};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(i.ComboboxControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,n.__)("Select Product","woo-vipps"),isLoading:d,value:t.productId?t.productId.toString():"",onChange:t=>{const e=parseInt(null!=t?t:"");if(isNaN(e))return void v();const n=c.find((o=>o.value===t));if(!n)return void v();const s=n.label;a(s),o({productId:e,productName:s})},onFilterValueChange:a,options:c,help:(0,n.__)("Type at least 3 characters to search products","woo-vipps")}),(0,p.jsx)(i.Button,{variant:"primary",onClick:()=>{t.productId&&t.productId&&s()},children:(0,n.__)("Confirm","woo-vipps")})]})}const d=vippsBuyNowBlockConfig;function w(){return(0,p.jsx)("img",{className:"block-editor-block-icon has-colors vipps-smile vipps-component-cion",src:d.vippssmileurl})}const v=JSON.parse('{"UU":"woo-vipps/buy-now"}');(0,o.registerBlockType)(v.UU,{edit:function({context:t,attributes:o,setAttributes:r}){var c,l;t.query&&r({hasProductContext:!0});const v=null!==(l=(null!==(c=d.logos[o.language])&&void 0!==c?c:d.logos.en)[o.variant])&&void 0!==l?l:"default",b=!o.hasProductContext,[h,g]=(0,e.useState)(!(o.hasProductContext||o.productId));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{...(0,s.useBlockProps)({className:"wp-block-button wc-block-components-product-button wc-block-button-vipps"}),children:h?(0,p.jsxs)("div",{className:"vipps-buy-now-block-edit-container",children:[(0,p.jsxs)("div",{className:"vipps-buy-now-block-edit-header",children:[(0,p.jsx)(w,{}),d.vippsbuynowbutton]}),(0,p.jsx)(u,{attributes:o,setAttributes:r,hideCallback:()=>g(!1)})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("a",{className:"single-product button vipps-buy-now wp-block-button__link",title:d.BuyNowWithVipps,children:(0,p.jsx)("img",{className:"inline vipps-logo-negative",src:v,alt:d.BuyNowWithVipps})}),b&&(0,p.jsx)(s.BlockControls,{children:(0,p.jsx)(i.ToolbarGroup,{children:(0,p.jsx)(i.ToolbarButton,{icon:a,label:(0,n.__)("Edit product","woo-vipps"),onClick:()=>g(!0)})})})]})}),(0,p.jsx)(s.InspectorControls,{children:(0,p.jsxs)(i.PanelBody,{children:[(0,p.jsx)(i.SelectControl,{onChange:t=>r({variant:t}),label:(0,n.__)("Variant","woo-vipps"),value:o.variant,options:d.variants,help:(0,n.__)("Choose the button variant with the perfect fit for your site","woo-vipps")}),(0,p.jsx)(i.SelectControl,{onChange:t=>r({language:t}),label:(0,n.__)("Language","woo-vipps"),value:o.language,options:d.languages,help:(0,n.__)("Choose language","woo-vipps")})]})})]})},title:d.vippsbuynowbutton,description:d.vippsbuynowdescription,icon:(0,p.jsx)(w,{})})})();