(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.element,n=window.wp.apiFetch;var a=e.n(n);const c=window.wp.i18n;function i({logo:e}){return(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__logo"},(0,t.createElement)("img",{src:e,alt:"Logo"})),(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__loading"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__loading__spinner"})),(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__text"},(0,t.createElement)("p",null,(0,c.__)("Verifying your payment. Please wait.","woo-vipps")),(0,t.createElement)("p",null,(0,c.__)("You will be redirected shortly.","woo-vipps"))))))}function p({continueShoppingUrl:e,logo:r}){return(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__logo"},(0,t.createElement)("img",{src:r,alt:"Logo"})),(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__text"},(0,t.createElement)("p",null,(0,t.createElement)("h1",{className:"vipps-recurring-payment-redirect-page__container__content__text__heading"},(0,c.__)("Order cancelled","woo-vipps"))),(0,t.createElement)("p",null,(0,c.__)("Your payment has been cancelled.","woo-vipps")),(0,t.createElement)("p",null,(0,t.createElement)("a",{href:e,className:"btn button vipps-recurring-payment-redirect-page__container__content__text__action"},(0,c.__)("Continue shopping","woo-vipps")))))))}function o({continueShoppingUrl:e,logo:r}){return(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content"},(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__logo"},(0,t.createElement)("img",{src:r,alt:"Logo"})),(0,t.createElement)("div",{className:"vipps-recurring-payment-redirect-page__container__content__text"},(0,t.createElement)("p",null,(0,t.createElement)("h1",{className:"vipps-recurring-payment-redirect-page__container__content__text__heading"},(0,c.__)("An error occurred","woo-vipps"))),(0,t.createElement)("p",null,(0,c.__)("An unknown error has occurred.","woo-vipps")),(0,t.createElement)("p",null,(0,t.createElement)("a",{href:e,className:"btn button vipps-recurring-payment-redirect-page__container__content__text__action"},(0,c.__)("Continue shopping","woo-vipps")))))))}var l,_;document.getElementById("vipps-mobilepay-recurring-app")&&(l=document.querySelector("#vipps-mobilepay-recurring-app"),_=(0,t.createElement)((function(){const{logo:e,continueShoppingUrl:n}=window.VippsMobilePaySettings,c=new URLSearchParams(window.location.search),[l,_]=(0,r.useState)(null),[s,m]=(0,r.useState)(!1),[u,g]=(0,r.useState)(0),d=(0,r.useRef)(null),v=(0,r.useCallback)((()=>{a()({path:`/vipps-mobilepay-recurring/v1/orders/status/${c.get("order_id")}?key=${c.get("key")}`,method:"GET"}).then((e=>_(e))).catch((()=>{g((e=>e+1))}))}),[]);(0,r.useEffect)((()=>(v(),d.current=setInterval(v,1e4),()=>clearInterval(d.current))),[]),(0,r.useEffect)((()=>{m(u>=4)}),[u]),(0,r.useEffect)((()=>{s?clearInterval(d.current):l&&"PENDING"!==l.status&&!E&&(clearInterval(d.current),l.redirect_url&&(window.location.href=l.redirect_url))}),[l,s]);const E=(0,r.useMemo)((()=>!!l&&["EXPIRED","STOPPED"].includes(l.status)),[l]);return(0,t.createElement)(t.Fragment,null,!s&&(0,t.createElement)(t.Fragment,null,E?(0,t.createElement)(p,{logo:e,continueShoppingUrl:n}):(0,t.createElement)(i,{logo:e})),s&&(0,t.createElement)(o,{logo:e,continueShoppingUrl:n}))}),null),r.createRoot?(0,r.createRoot)(l).render(_):(0,r.render)(_,l))})();