{"version":3,"file":"product-shareable-link/index.js","mappings":"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","sources":["webpack://blocks/./src/product-shareable-link/edit.tsx","webpack://blocks/./src/product-shareable-link/editor.scss","webpack://blocks/external window \"React\"","webpack://blocks/external window [\"wc\",\"blockTemplates\"]","webpack://blocks/external window [\"wc\",\"components\"]","webpack://blocks/external window [\"wc\",\"productEditor\"]","webpack://blocks/external window [\"wp\",\"components\"]","webpack://blocks/external window [\"wp\",\"i18n\"]","webpack://blocks/webpack/bootstrap","webpack://blocks/webpack/runtime/compat get default export","webpack://blocks/webpack/runtime/define property getters","webpack://blocks/webpack/runtime/hasOwnProperty shorthand","webpack://blocks/webpack/runtime/make namespace object","webpack://blocks/./src/product-shareable-link/index.ts"],"sourcesContent":["/**\n * External dependencies\n */\nimport type { BlockAttributes } from '@wordpress/blocks';\nimport { useWooBlockProps } from '@woocommerce/block-templates';\nimport { createElement } from '@wordpress/element';\nimport { Table } from '@woocommerce/components';\nimport { SelectControl, Button, Spinner } from '@wordpress/components';\n\nimport { __, sprintf } from '@wordpress/i18n';\nimport { __experimentalUseProductEntityProp as useProductEntityProp } from '@woocommerce/product-editor';\nimport { useState } from 'react';\n\ninterface Metadata {\n\tkey: string;\n\tvalue: any;\n\tid: number | null;\n}\ninterface MetadataShareableLink {\n\tkey: string;\n\tid: number | null;\n\tvalue: {\n\t\tproduct_id: number;\n\t\tvariation_id: number;\n\t\tkey: string;\n\t\turl: string;\n\t\tvariant: string;\n\t};\n}\ninterface SharedLinkBlockAttributes extends BlockAttributes {\n\ttitle: string;\n\tmessage: string;\n}\n// Extend the window object to include some WP global variables\ndeclare global {\n\tinterface Window {\n\t\tajaxurl: string;\n\t}\n}\n\n/**\n * The edit function describes the structure of the woo-vipps/product-shareable-link block in the editor.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-edit-save/#edit\n *\n */\nexport function Edit( {\n\tattributes,\n}: {\n\tattributes: SharedLinkBlockAttributes;\n} ) {\n\t// Get variations\n\tconst [ variations = [] ] =\n\t\tuseProductEntityProp< number[] >( 'variations' );\n\tconst shouldEnableVariations = variations.length > 0;\n\tconst [ productId ] = useProductEntityProp< string >( 'id' );\n\tconst blockProps = useWooBlockProps( attributes );\n\tconst [ metadata = [], setMetadata ] =\n\t\tuseProductEntityProp< Metadata[] >( 'meta_data' );\n\tconst [ shareLinkNonce ] =\n\t\tuseProductEntityProp< string >( 'share_link_nonce' );\n\n\t// Because of they way meta_data is stored, we need to filter any metadata that starts with _vipps_shareable_links\n\tconst links: MetadataShareableLink[] = metadata.filter(\n\t\t( meta ) =>\n\t\t\t// Keep only the metadata that starts with _vipps_shareable_links\n\t\t\tmeta.key.startsWith( '_vipps_shareable_links' ) &&\n\t\t\t// Keep only the metadata that has a value, if the value is undefined, it means it was just deleted\n\t\t\tmeta.value !== undefined\n\t);\n\n\t// Some state to manage the \"loading/copying\" state of the copy button, this is initialized as null, and set to the URL being copied when the button is clicked\n\tconst [ isCopyingURLValue, setIsCopyingURLValue ] = useState<\n\t\tstring | null\n\t>( null );\n\t// State to manage the selected variant\n\tconst [ variant, setVariant ] = useState< number | null >( null );\n\t// State to keep track of loading state of new shareable link creation\n\tconst [ isLoading, setIsLoading ] = useState( false );\n\n\t/**\n\t * Copies the given URL to the clipboard.\n\t *\n\t * @param url - The URL to be copied.\n\t */\n\tasync function copyToClipboard( url: string ) {\n\t\tsetIsCopyingURLValue( url );\n\t\t// Use the Clipboard API if available\n\t\tif ( navigator.clipboard ) {\n\t\t\tnavigator.clipboard.writeText( url );\n\t\t} else {\n\t\t\t// Fallback to using deprecated document.execCommand\n\t\t\tconst textArea = document.createElement( 'textarea' );\n\t\t\ttextArea.value = url;\n\t\t\tdocument.body.appendChild( textArea );\n\t\t\ttextArea.select();\n\t\t\tdocument.execCommand( 'copy' );\n\t\t\tdocument.body.removeChild( textArea );\n\t\t}\n\t\t// Wait for 2.5 seconds before resetting the state\n\t\tawait new Promise( ( resolve ) => setTimeout( resolve, 2500 ) );\n\t\tsetIsCopyingURLValue( null );\n\t}\n\n\tasync function createShareableLink() {\n\t\ttry {\n\t\t\tsetIsLoading( true );\n\t\t\tconst params = new URLSearchParams( {\n\t\t\t\taction: 'vipps_create_shareable_link',\n\t\t\t\tvipps_share_sec: shareLinkNonce!,\n\t\t\t\tprodid: productId!,\n\t\t\t\tvarid: variant?.toString() || '0',\n\t\t\t} );\n\t\t\tconst response = await fetch( window.ajaxurl, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: params.toString(),\n\t\t\t\tcredentials: 'include',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type':\n\t\t\t\t\t\t'application/x-www-form-urlencoded; charset=UTF-8',\n\t\t\t\t},\n\t\t\t} );\n\t\t\t// Throw early if the response is not ok\n\t\t\tif ( ! response.ok ) {\n\t\t\t\tthrow new Error();\n\t\t\t}\n\n\t\t\t// Parse the response as JSON\n\t\t\tconst result = ( await response.json() ) as {\n\t\t\t\tok: boolean;\n\t\t\t\tvariant: string;\n\t\t\t\turl: string;\n\t\t\t\tkey: string;\n\t\t\t\tmsg: string;\n\t\t\t};\n\t\t\t// Append this new shareable link to the list of existing links\n\t\t\tif ( result.ok ) {\n\t\t\t\tsetMetadata( [\n\t\t\t\t\t...metadata,\n\t\t\t\t\t{\n\t\t\t\t\t\tkey: '_vipps_shareable_links',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\tproduct_id: productId,\n\t\t\t\t\t\t\tvariation_id: variant,\n\t\t\t\t\t\t\tkey: result.key,\n\t\t\t\t\t\t\turl: result.url,\n\t\t\t\t\t\t\tvariant: result.variant,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tid: -1,\n\t\t\t\t\t},\n\t\t\t\t] );\n\t\t\t} else {\n\t\t\t\tthrow new Error( result.msg );\n\t\t\t}\n\t\t} catch ( error ) {\n\t\t\tif ( error instanceof Error ) {\n\t\t\t\t// TODO: use toast or similar instead of alert\n\t\t\t\talert(\n\t\t\t\t\t__( 'Error creating shareable link.', 'woo-vipps' ) +\n\t\t\t\t\t\terror.message\n\t\t\t\t);\n\t\t\t}\n\t\t} finally {\n\t\t\tsetIsLoading( false );\n\t\t}\n\t}\n\n\t/**\n\t * Removes a shareable link from the metadata.\n\t *\n\t * @param key - The key of the shareable link to remove.\n\t */\n\tfunction removeShareableLink( key: string ) {\n\t\tconst newMetadata = metadata.map(\n\t\t\t( meta: Metadata | MetadataShareableLink ) => {\n\t\t\t\t// Since we keep 2 separate keys for every 1 shareable link, we need to check for both and remove them\n\t\t\t\t// Key 1\n\t\t\t\tconst isShareableLinksMeta =\n\t\t\t\t\tmeta.key.startsWith( '_vipps_shareable_links' ) &&\n\t\t\t\t\tmeta.value?.key == key;\n\n\t\t\t\t// Key 2\n\t\t\t\tconst isShareableLinkSpecificKeyMeta =\n\t\t\t\t\tmeta.key === '_vipps_shareable_links' &&\n\t\t\t\t\tmeta?.value?.key == key;\n\n\t\t\t\t// Remove the value if it matches the key, this will cause the meta to be deleted\n\t\t\t\tif ( isShareableLinksMeta || isShareableLinkSpecificKeyMeta ) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...meta,\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn meta;\n\t\t\t}\n\t\t);\n\t\t// Update the metadata\n\t\tsetMetadata( newMetadata );\n\t}\n\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t<span>{ attributes.title }</span>\n\t\t\t<div>\n\t\t\t\t<div className=\"create-link-section\">\n\t\t\t\t\t{ shouldEnableVariations && (\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tclassName=\"vipps-sharelink-variant\"\n\t\t\t\t\t\t\tvalue={ variant?.toString() }\n\t\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\t\tsetVariant( parseInt( value, 10 ) )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlabel={ __( 'Variation', 'woo-vipps' ) }\n\t\t\t\t\t\t\toptions={ variations.map( ( variation ) => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tlabel: variation.toString(),\n\t\t\t\t\t\t\t\t\tvalue: variation.toString(),\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\tdisabled={ isLoading }\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tonClick={ createShareableLink }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ isLoading && <Spinner /> }\n\t\t\t\t\t\t{ __( 'Create shareable link', 'woo-vipps' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{ /* Table which render a list of available shareable links of this product */ }\n\t\t\t\t<Table\n\t\t\t\t\theaders={ [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkey: 'variant',\n\t\t\t\t\t\t\tlabel: __( 'Variation', 'woo-vipps' ),\n\t\t\t\t\t\t\tvisible: shouldEnableVariations,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkey: 'link',\n\t\t\t\t\t\t\tlabel: __( 'Link', 'woo-vipps' ),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkey: 'actions',\n\t\t\t\t\t\t\tlabel: __( 'Actions', 'woo-vipps' ),\n\t\t\t\t\t\t\tcellClassName: 'table-actions-col',\n\t\t\t\t\t\t},\n\t\t\t\t\t].filter( ( header ) => header.visible !== false ) } // Filter out any headers that are not visible\n\t\t\t\t\trows={ links.map( ( item ) => {\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tkey: 'variant',\n\t\t\t\t\t\t\t\tdisplay: item.value.variant,\n\t\t\t\t\t\t\t\tvisible: shouldEnableVariations,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tkey: 'link',\n\t\t\t\t\t\t\t\tdisplay: (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\thref={ item.value.url }\n\t\t\t\t\t\t\t\t\t\tvariant=\"link\"\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ item.value.url }\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tkey: 'actions',\n\t\t\t\t\t\t\t\tdisplay: (\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tdisabled={\n\t\t\t\t\t\t\t\t\t\t\t\t// Disable copy button if any url is being copied\n\t\t\t\t\t\t\t\t\t\t\t\tisCopyingURLValue !== null\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tonClick={ () =>\n\t\t\t\t\t\t\t\t\t\t\t\tcopyToClipboard(\n\t\t\t\t\t\t\t\t\t\t\t\t\titem.value.url\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{ /* Conditionally show copied message */ }\n\t\t\t\t\t\t\t\t\t\t\t{ isCopyingURLValue ===\n\t\t\t\t\t\t\t\t\t\t\titem.value.url\n\t\t\t\t\t\t\t\t\t\t\t\t? __( 'Copied!', 'woo-vipps' )\n\t\t\t\t\t\t\t\t\t\t\t\t: __( 'Copy', 'woo-vipps' ) }\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tonClick={ () =>\n\t\t\t\t\t\t\t\t\t\t\t\tremoveShareableLink(\n\t\t\t\t\t\t\t\t\t\t\t\t\titem.value.key\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{ __( 'Delete', 'woo-vipps' ) }\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t].filter(row => row.visible !== false); // Filter out any rows that are not visible\n\t\t\t\t\t} ) }\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<p dangerouslySetInnerHTML={ { __html: attributes.message } }></p>\n\t\t</div>\n\t);\n}\n","// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"React\"];","module.exports = window[\"wc\"][\"blockTemplates\"];","module.exports = window[\"wc\"][\"components\"];","module.exports = window[\"wc\"][\"productEditor\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * External dependencies\n */\nimport { registerProductEditorBlockType } from '@woocommerce/product-editor';\n/**\n * Internal dependencies\n */\nimport './editor.scss'; // see https://www.npmjs.com/package/@wordpress/scripts#using-css\n\n/**\n * Internal dependencies\n */\nimport { Edit } from './edit';\nimport metadata from './block.json';\n\n/**\n * Every block starts by registering a new block type definition.\n *\n * @see https://developer.wordpress.org/block-editor/developers/block-api/#registering-a-block\n */\n\nregisterProductEditorBlockType({\n\tmetadata: metadata as never,\n\tsettings: {\n\t\tedit:Edit\n\t}\n} );\n"],"names":["useWooBlockProps","Table","SelectControl","Button","Spinner","__","__experimentalUseProductEntityProp","useProductEntityProp","useState","Edit","attributes","variations","shouldEnableVariations","length","productId","blockProps","metadata","setMetadata","shareLinkNonce","links","filter","meta","key","startsWith","value","undefined","isCopyingURLValue","setIsCopyingURLValue","variant","setVariant","isLoading","setIsLoading","copyToClipboard","url","navigator","clipboard","writeText","textArea","document","createElement","body","appendChild","select","execCommand","removeChild","Promise","resolve","setTimeout","createShareableLink","params","URLSearchParams","action","vipps_share_sec","prodid","varid","toString","response","fetch","window","ajaxurl","method","credentials","headers","ok","Error","result","json","product_id","variation_id","id","msg","error","alert","message","removeShareableLink","newMetadata","map","isShareableLinksMeta","isShareableLinkSpecificKeyMeta","title","className","onChange","parseInt","label","options","variation","disabled","type","onClick","visible","cellClassName","header","rows","item","display","href","target","row","dangerouslySetInnerHTML","__html","registerProductEditorBlockType","settings","edit"],"sourceRoot":""}